@page
@model Pet_Reunion_Hub.Pages.PETMEMORIAL.POSTS.IndexModel

@{
    ViewData["Title"] = "Index";
    // Layout = "~/Pages/Shared/SignUp.cshtml";
}
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Mvc.RazorPages

<style>

    #createnew {
        border-radius: 5px;
        background-color: black;
        color: white;
        text-decoration: none;
        padding: 10px 20px;
        font-weight: bold;
        transition: background-color 0.3s;
    }

        #createnew:hover {
            background-color: #555;
        }

    #edit {
        border-radius: 5px;
        background-color: black;
        color: white;
        text-decoration: none;
        padding: 5px 10px;
        font-weight: bold;
    }


    #details {
        border-radius: 5px;
        background-color: #8b572a;
        color: white;
        text-decoration: none;
        padding: 5px 10px;
        font-weight: bold;
    }


    #delete {
        border-radius: 5px;
        background-color: red;
        color: white;
        text-decoration: none;
        padding: 5px 10px;
        font-weight: bold;
    }

    .highlight {
        background-color: yellow;
    }
</style>
<h1>Your Moments and Stories</h1>
<br/>
<p>
    Welcome to Your Moments and Stories. Here, you can store cherished memories of your beloved pet by creating different posts for each story.
    Feel free to add photos, videos, and audio recordings to preserve those special moments forever.
</p>
<p>
    <a asp-page="Create" id="createnew">Create a New Story</a>
</p>

<input style="border-radius:20px; height:40px; width: 500px;" type="text" id="searchInput" onkeyup="searchFunction()" placeholder="Search">
<br />


<br/>
    @foreach (var item in Model.Post.Reverse())
    {
        <div class="post" style="border: 1px solid #ccc; padding: 30px; margin-bottom: 20px;  border-radius: 5px; background-color: #fff;">
            
            @* <p><strong>Pet Name:</strong> @item.PetName</p> *@
           
        <p><strong>Caption:</strong>
        <p class="searchable">@(string.IsNullOrEmpty(item.Content) ? "-" : item.Content) </p>
        <br />

      @*       <p><strong>Visibility</strong> @item.IsPublic</p>
           *@

            @if (item.Media != null && item.Media.Any())
            {
                <p><strong>Media:</strong></p>
                <div class="media-container">
                    @foreach (var mediaItem in item.Media)
                    {
                        <img src="@mediaItem.MediaUrl" alt="Media Image" style="max-width: 200px; margin-right: 10px;">
                    }
                </div>
            }
         
            <p><strong>Created on:</strong> @item.CreatedAt.ToString("yyyy-MM-dd HH:mm:ss")</p>

            <p>
                <a asp-page="./Edit" asp-route-id="@item.Id" id="edit">Edit</a> 
                <a asp-page="./Details" asp-route-id="@item.Id" id="details">Details</a> 
                <a asp-page="./Delete" asp-route-id="@item.Id" id="delete">Delete</a>
            </p>
        </div>
    }
<script>
    function searchFunction() {
        var input = document.getElementById("searchInput");
        var filter = input.value.toUpperCase();
        var reports = document.getElementsByClassName("post");

        for (var i = 0; i < reports.length; i++) {
            var report = reports[i];
            var searchableElements = report.getElementsByClassName("searchable");
            var found = false;

            for (var j = 0; j < searchableElements.length; j++) {
                var nameElement = searchableElements[j];
                var text = nameElement.textContent.toUpperCase();

                if (text.indexOf(filter) > -1) {
                    found = true;
                    // Highlight the matching text
                    var newText = text.replace(new RegExp('(' + filter + ')', 'ig'), '<span class="highlight">$1</span>');
                    nameElement.innerHTML = newText;
                }
            }

            if (found) {
                report.style.display = "";
            } else {
                report.style.display = "none";
            }
        }
    }
</script>

